# UI 设计

本文档介绍 bm.md 的用户界面设计，仅关注视觉与交互层面。

---

## 整体布局

### 页面结构

```
┌─────────────────────────────────────────────────────────────┐
│  [文件1] [文件2] [文件3] [+]              文件标签栏          │
├─────────────────────────┬───────────────────────────────────┤
│                         │                                   │
│                         │                                   │
│       Markdown          │         实时预览                   │
│        编辑器            │                                   │
│                         │      ┌─────────────────┐          │
│                         │      │   设备模拟框    │          │
│                         │      │   (iPhone/     │          │
│                         │      │    Safari)     │          │
│                         │      └─────────────────┘          │
│                         │                                   │
│                         │                                   │
├─────────────────────────┴───────────────────────────────────┤
│  [编辑器操作]           bm.md           [预览器操作]         │
│                        底部功能栏                            │
└─────────────────────────────────────────────────────────────┘
```

### 布局特点

- **文件标签栏** - 顶部显示打开的文件，支持多文件切换
- **左右分屏** - 编辑器与预览器各占 50%
- **可调节分割** - 拖拽中间分割线调整比例
- **最小宽度** - 每侧最小 512px，整体最小 1280px
- **固定底栏** - 高度 48px，承载所有操作按钮

### 文件标签栏

```
┌─────────────────────────────────────────────────────────────┐
│ [📄 bm.md ✕] [📄 README.md ✕] [📄 notes.md ✕]    │ [+] │
│              打开的文件标签                      │ 新建 │
└─────────────────────────────────────────────────────────────┘
```

- **活动标签** - 高亮显示当前编辑的文件
- **关闭按钮** - 每个标签右侧有关闭按钮
- **双击重命名** - 双击标签可重命名文件
- **滚动支持** - 标签过多时可横向滚动
- **新建按钮** - 右侧固定的 + 按钮创建新文件

### 底部功能栏

```
┌─────────────────────────────────────────────────────────────┐
│ [导入] [导出] [格式化] [设置▾]    bm.md    [样式▾] [主题] [复制▾] │
│        编辑器操作                Logo           预览器操作    │
└─────────────────────────────────────────────────────────────┘
```

- **左侧** - 编辑器相关操作（导入、导出、格式化、设置）
- **中间** - Logo（点击打开关于页面）
- **右侧** - 预览器相关操作（样式选择、主题切换、复制导出）

---

## 配色系统

### Ayu 主题

基于 [Ayu](https://github.com/ayu-theme/ayu-colors) 配色方案，统一整个应用的视觉风格：

#### 浅色模式 (Ayu Light)

| 用途      | 颜色                                                     | 色值      |
| --------- | -------------------------------------------------------- | --------- |
| 背景      | ![#fcfcfc](https://via.placeholder.com/16/fcfcfc/fcfcfc) | `#fcfcfc` |
| 次级背景  | ![#f8f9fa](https://via.placeholder.com/16/f8f9fa/f8f9fa) | `#f8f9fa` |
| 前景文字  | ![#5c6166](https://via.placeholder.com/16/5c6166/5c6166) | `#5c6166` |
| 强调色    | ![#f29718](https://via.placeholder.com/16/f29718/f29718) | `#f29718` |
| 链接/信息 | ![#55b4d4](https://via.placeholder.com/16/55b4d4/55b4d4) | `#55b4d4` |
| 成功      | ![#6cbf43](https://via.placeholder.com/16/6cbf43/6cbf43) | `#6cbf43` |
| 错误      | ![#e65050](https://via.placeholder.com/16/e65050/e65050) | `#e65050` |

#### 深色模式 (Ayu Mirage)

| 用途      | 颜色                                                     | 色值      |
| --------- | -------------------------------------------------------- | --------- |
| 背景      | ![#1f2430](https://via.placeholder.com/16/1f2430/1f2430) | `#1f2430` |
| 次级背景  | ![#242936](https://via.placeholder.com/16/242936/242936) | `#242936` |
| 前景文字  | ![#cccac2](https://via.placeholder.com/16/cccac2/cccac2) | `#cccac2` |
| 强调色    | ![#ffcc66](https://via.placeholder.com/16/ffcc66/ffcc66) | `#ffcc66` |
| 链接/信息 | ![#5ccfe6](https://via.placeholder.com/16/5ccfe6/5ccfe6) | `#5ccfe6` |
| 成功      | ![#87d96c](https://via.placeholder.com/16/87d96c/87d96c) | `#87d96c` |
| 错误      | ![#ff6666](https://via.placeholder.com/16/ff6666/ff6666) | `#ff6666` |

### 色彩技术

- **OKLCH 色彩空间** - 使用现代 CSS 色彩格式，确保感知一致性
- **CSS 变量** - 通过 CSS 变量映射到 shadcn/ui 组件
- **语义化命名** - `--primary`、`--secondary`、`--destructive` 等

---

## 编辑器设计

### CodeMirror 编辑器

````
┌─────────────────────────────────────┐
│  1 │ # 标题                         │
│  2 │                                │
│  3 │ 这是一段正文，包含 **粗体** 文字  │
│  4 │                                │
│  5 │ ```javascript                  │
│  6 │ console.log('Hello')           │
│  7 │ ```                            │
│    │                                │
│    │                                │
└─────────────────────────────────────┘
````

#### 视觉特点

- **行号** - 左侧显示行号，使用次级文字颜色
- **语法高亮** - Markdown 语法实时着色
- **当前行** - 当前编辑行轻微高亮
- **光标** - 使用强调色（橙色）

#### 字体

- **编辑器字体** - 系统等宽字体
- **字号** - 14px
- **行高** - 1.6

---

## 预览器设计

### 设备模拟框

预览内容展示在设备模拟框中，增强真实感：

#### 移动端视图 - iPhone

```
        ┌─────────────────┐
        │    ○ ○ ○        │  ← 刘海
        ├─────────────────┤
        │                 │
        │   Markdown      │
        │   预览内容       │
        │                 │
        │                 │
        │                 │
        └─────────────────┘
```

- 宽度：415px
- 圆角边框
- 顶部刘海装饰（Dynamic Island）

#### 桌面端视图 - Safari

```
┌─────────────────────────────────────┐
│ ● ● ●  │    bm.md    │             │  ← 标题栏
├─────────────────────────────────────┤
│                                     │
│         Markdown 预览内容            │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

- 最大宽度：768px
- 浏览器窗口装饰（红黄绿按钮）
- 地址栏显示 "bm.md"

### 侧边栏

预览区域右侧有快捷操作侧边栏：

```
┌───┐
│ ☀ │  ← 主题切换
├───┤
│ 📱│  ← 移动端视图
├───┤
│ 🖥 │  ← 桌面端视图
├───┤
│ 🎨│  ← 自定义 CSS
├───┤
│ ⚙ │  ← 更多设置
└───┘
```

### 自定义 CSS 对话框

点击侧边栏画笔图标打开自定义 CSS 配置：

```
┌─────────────────────────────────────────────────────────────┐
│                    自定义 CSS                           ✕   │
├─────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────┐  │
│  │ /* 修改标题颜色 */                                      │  │
│  │ #bm-md h1 {                                            │  │
│  │   color: #e74c3c;                                      │  │
│  │ }                                                      │  │
│  │                                                        │  │
│  │ /* 调整段落行高 */                                      │  │
│  │ #bm-md p {                                             │  │
│  │   line-height: 1.8;                                    │  │
│  │ }                                                      │  │
│  └───────────────────────────────────────────────────────┘  │
│                                                             │
│  提示：CSS 选择器需约束在 #bm-md 下                          │
│                                                     [保存]  │
└─────────────────────────────────────────────────────────────┘
```

- **实时预览** - 修改后即时应用到预览区域
- **自动保存** - 配置保存到本地存储
- **语法提示** - 提示选择器约束规则

---

## 命令面板

类似 macOS Spotlight 的全局命令面板：

```
┌─────────────────────────────────────────────────────────────┐
│  🔍 搜索命令...                                              │
├─────────────────────────────────────────────────────────────┤
│  编辑器                                                      │
│  ├─ 📥 导入文件                                    ⌘O        │
│  ├─ 📤 导出 Markdown                               ⌘S        │
│  └─ ✨ 格式化内容                                  ⌘⇧L       │
├─────────────────────────────────────────────────────────────┤
│  复制导出                                                    │
│  ├─ 💬 复制为微信格式                              ⌘⇧7       │
│  ├─ 📝 复制为知乎格式                              ⌘⇧8       │
│  ├─ 📰 复制为掘金格式                              ⌘⇧9       │
│  └─ 🖼️ 导出图片                                             │
├─────────────────────────────────────────────────────────────┤
│  外观设置                                                    │
│  ├─ 🌙 切换到深色模式                                        │
│  ├─ 🎨 排版样式                                      →       │
│  └─ 💻 代码主题                                      →       │
└─────────────────────────────────────────────────────────────┘
```

### 交互特点

- **快捷键唤起** - `Cmd/Ctrl + K`
- **模糊搜索** - 输入关键词过滤命令
- **子菜单** - 主题选择等有二级菜单
- **快捷键提示** - 右侧显示对应快捷键

---

## 主题切换动画

使用 View Transition API 实现平滑的主题切换效果：

### 动画效果

```
浅色 → 深色切换

    ┌─────────────────┐
    │  ○ 动画起点      │
    │    ╲            │
    │      ╲ 圆形扩散  │
    │        ╲        │
    │          ╲      │
    └─────────────────┘
```

- **起点** - 右上角
- **效果** - 圆形模糊扩散
- **遮罩** - 使用 `blur-mask.svg`
- **时长** - 约 300ms

---

## 弹窗设计

关于页面、MCP 配置、Skill 文档等使用弹窗展示：

```
┌─────────────────────────────────────────────────────────────┐
│                                                         ✕   │
│                                                             │
│                      弹窗标题                                │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│                      弹窗内容                                │
│                                                             │
│                                                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 特点

- **模态弹窗** - 覆盖在主界面上方
- **背景模糊** - 半透明遮罩 + 模糊效果
- **保持状态** - 打开弹窗不影响编辑器内容
- **关闭方式** - 点击 ✕ 或按 ESC

---

## 响应式设计

### 预览宽度自适应

预览区域根据容器宽度自动调整：

| 容器宽度 | 预览模式 | 预览宽度       |
| -------- | -------- | -------------- |
| < 600px  | 移动端   | 415px          |
| ≥ 600px  | 用户偏好 | 415px 或 768px |

### 最小屏幕要求

- 最小宽度：1280px（5xl）
- 最小高度：700px

### 容器查询

使用现代 CSS 容器查询实现父元素感知的响应式布局：

- `@container` 规则用于组件内部适配
- `ResizeObserver` 检测容器尺寸变化
- 支持 `orientation="responsive"` 的表单字段布局

---

## 组件风格

### 按钮

- **主要按钮** - 强调色背景，白色文字
- **次要按钮** - 透明背景，边框样式
- **图标按钮** - 仅图标，悬停显示 Tooltip
- **圆角** - 统一使用 `rounded-none`（直角风格）

### 下拉菜单

- 直角卡片样式
- 轻微阴影
- 选中项显示勾选标记

### 输入框

- 直角边框
- 聚焦时边框高亮
- 清晰的占位符文字

### 滚动条

- 细线样式（6px 宽）
- 仅悬停时显示
- 与主题配色一致
